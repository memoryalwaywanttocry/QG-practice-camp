### 变换

1模型变换，2视图变换

3维世界到2维平面的变换

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331181017.png" alt="QQ截图20210331181017" style="zoom: 50%;" />

##### 2维的变换

矩阵的变换

缩放  x和y可以不均匀缩放

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331181241.png" alt="QQ截图20210331181241" style="zoom:50%;" />

反射，对称的操作 对称轴y,x 变-x

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331181514.png" alt="QQ截图20210331181514" style="zoom:50%;" />

切变 水平方向改变，y方向不变   y=0 底边移动为0   顶边所有点移动距离都是a，中间水平线x的左边移动都是1/2 的a。任何水平方向上的移动，都是ay,即 x' = x+ay

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331182843.png" alt="QQ截图20210331182843" style="zoom:50%;" />

rotate 旋转

2维旋转不说明怎么旋转时，默认绕原点。不说明旋转方向，默认是逆时针方向。图旋转45° == 图绕中心点逆时针旋转45°，记为R45

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331182717.png" alt="QQ截图20210331182717" style="zoom:50%;" />

以上是旋转theta角时的公式，以下的是 -theta角，往相反的方向旋转相同的角度。该旋转矩阵的逆等于旋转矩阵的转置。在线代中也称之为正交矩阵，一个矩阵的逆等于它的转置。用处：<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331200132.png" alt="QQ截图20210331200132" style="zoom:50%;" />

线性变换：

一个矩阵乘以一个向量变成另一个向量(要用相同维度的矩阵乘向量)

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331183645.png" alt="QQ截图20210331183645" style="zoom:50%;" />

平移变换：

不是线性变换，是一个特殊情况

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331184305.png" alt="QQ截图20210331184305" style="zoom: 67%;" />

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331183952.png" alt="QQ截图20210331183952" style="zoom:50%;" />



齐次坐标：(想要把多种变化用一个统一格式表示)

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331184603.png" alt="QQ截图20210331184603" style="zoom:50%;" />

2D点第3维为1，2D向量平移不变性，第三维为0.

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331185659.png" alt="QQ截图20210331185659" style="zoom:50%;" />

仿射变换(都能写成齐次坐标的形式)

用一个矩阵统一了多种变换，第三行为0，0，1   平移写在最后一列  (2维情况下的仿射变换)<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331185929.png" alt="QQ截图20210331185929" style="zoom:50%;" />

逆变换

变换的顺序 矩阵在最右边，变换顺序从矩阵的左边第一个变换到最左边

矩阵的应用是从右到左的

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331192917.png" alt="QQ截图20210331192917" style="zoom:50%;" />

想以任意一个点作变换，可以先把要变换的点移到原点，作了变换之后再移回去

分解变换步骤记住从右到左

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331192001.png" alt="QQ截图20210331192001" style="zoom:50%;" />

3维空间变换<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331192408.png" alt="QQ截图20210331192408" style="zoom:50%;" />

也能用齐次坐标来表示，最后一行还是0001，最后一列还是平移

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331194631.png" alt="QQ截图20210331194631" style="zoom:50%;" />与2D差不多，都是先线性变换，后平移，都能写成一个矩阵

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402125458.png" alt="QQ截图20210402125458" style="zoom:50%;" />

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331194546.png" alt="QQ截图20210331194546" style="zoom:50%;" />

绕什么轴旋转，什么轴就不变

循环对称的性质，X x Y = Z,Z x X = Y,Y x Z = X.  x->y->z->x->y-z

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210331204917.png" alt="QQ截图20210331204848" style="zoom:50%;" />

一般性的旋转是怎么转，转换为分解为普通的旋转

欧拉角，绕任意轴的旋转，都可以写成绕x,绕y,绕z轴旋转

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402130119.png" alt="QQ截图20210402130119" style="zoom:50%;" />

罗德里格斯旋转公式，此处认为任意轴的起点在原点上

（四元数，应用在旋转与旋转之间的差值）

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402130557.png" alt="QQ截图20210402130557" style="zoom: 50%;" />

##### Viewing transformation<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402125159.png" alt="QQ截图20210402125159" style="zoom: 50%;" />

:1，视图变换。2，投影变换：正交投影，透视投影

什么是视图变换。

思考：如何拍一张照片，1，模型变换，把人集中在一起摆好姿势

2，找一个好的相机位置角度 3，茄子<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402132132.png" alt="QQ截图20210402132132" style="zoom:50%;" />

MVP变换

如何确定相机摆放，1，摆放的位置位置。2，相机往哪看 look at /gaze direction。3，相机 的向上方向，相机的旋转。

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402132359.png" alt="QQ截图20210402132359" style="zoom:50%;" />

移完相机，想要拍出来的效果跟原来位置拍出来的效果不变，要把物体对相机的相对位置调整到不变。

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402132529.png" alt="QQ截图20210402132529" style="zoom: 67%;" />

固定相机的位置，只移动物体，相机永远放在原点，永远看向-z<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402132618.png" alt="QQ截图20210402132618" style="zoom:50%;" />

一一对应移动相机

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402132903.png" alt="QQ截图20210402132903" style="zoom:50%;" />

这里先作平移，后作旋转操作 

![QQ截图20210402133148](E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402133148.png)

为了保证相对运动不变，得到结果一样。其他物体按照相机变换的矩阵也作一次变换

总结，视图变换<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402180415.png" alt="QQ截图20210402180415" style="zoom:50%;" />

透视投影，平行线会相交到一起，近大远小

左，透视投影，右，正交投影（假设相机拿的无限远，近和远是一样的大小）

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402180752.png" alt="QQ截图20210402180752" style="zoom:50%;" />

扔掉z，投影

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402181022.png" alt="QQ截图20210402181022" style="zoom:50%;" />





### 正交投影：

定义左右，上下，远近来定义立方体

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402181153.png" alt="QQ截图20210402181153" style="zoom:50%;" />

把立方体的中心移到原点，把立方体的x，y，z轴都拉到一个标准立方体

因为沿着-z去看，z轴上数值远是小于近的

##### 第一步，把中心移到原点上。第二步，把x,y,z的长度变成2。

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402181623.png" alt="QQ截图20210402181623" style="zoom:50%;" />

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402205112.png" alt="QQ截图20210402205112" style="zoom:50%;" />

一个点乘上k,还是表示这个空间的点，k不为0

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402182400.png" alt="QQ截图20210402182400" style="zoom:50%;" />

### 透视投影：

把frustum变成cuboid

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402182750.png" alt="QQ截图20210402182750" style="zoom:50%;" />

近平面永远不变，把远平面挤成近平面大小的面，并且远F,近N的Z坐标不变

远平面的中心点也不会发生改变

从透视到正交，后作一次正交投影到屏幕上

相似三角形找出挤压后的远平面的y

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402183203.png" alt="QQ截图20210402183203" style="zoom:50%;" />

同样的，得出x与原来x的变化，然后剩下z未知，因为前面说过一个点乘以k还是表示这个点，所以，先这个点乘个z<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402202314.png" alt="QQ截图20210402202314" style="zoom:50%;" />

从已知的结果矩阵推出乘以的那个矩阵（4x4）的一部分：

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402202600.png" alt="QQ截图20210402202600" style="zoom:50%;" />

联想前面提到的，变化前后，近面远面不动，可以利用

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402202916.png" alt="QQ截图20210402202916" style="zoom:50%;" />



<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402202916.png" alt="QQ截图20210402202916" style="zoom:50%;" />



<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402203347.png" alt="QQ截图20210402203347" style="zoom:50%;" />

我们还应记得，远端面的中心点变化前后没有发生改变

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402203542.png" alt="QQ截图20210402203542" style="zoom:50%;" />



列出两条式子，因为n,f是已知的，可以求出A,B

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402203821.png" alt="QQ截图20210402203821" style="zoom:50%;" />

至此，我们就已经完成了将一个视锥体，挤成一个长方体，接下来，还要把长方体做正交投影。

<img src="E:\C++学习笔记Xmind\图形学之变换\QQ截图20210402204433.png" alt="QQ截图20210402204433" style="zoom:50%;" />